var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var bcrypt = require("bcrypt");

var userSchema = new Schema({
    firstname: {
        type: String,
		required: true
    },
	lastname: {
		type: String,
		required: true
	},
    username: {
        type: String,
        required: true,
        unique: true,
        lowercase: true
    },
    password: {
        type: String,
        required: true
    },
    email: String
});

userSchema.pre("save", function (next) {
    var user = this;

    if (!user.isModified("password")) {
        next();
    }

    bcrypt.hash(user.password, 10, function (err, hash) {
		console.log('password hook: ' + user.password);
        if (err) return next(err);

        user.password = hash;
        next();
    });
});

<<<<<<< 5cbaa417e5d177a3ce22f6540ea193105b5ca424
=======
//userSchema.pre('findOneAndUpdate', function(next) {
//	console.log('its here');
//	var user = this;
//	console.log(user.toJSON());
//    if (!user.isModified("password")) {
//        next();
//    }
//
//    bcrypt.hash(user.password, 10, function (err, hash) {
//		console.log('password hook: ' + user.password);
//        if (err) return next(err);
//
//        user.password = hash;
//        next();
//    });
//});
	
>>>>>>> adding ability for user info update and a nation.html file
module.exports = mongoose.model('User', userSchema);
